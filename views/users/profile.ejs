<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= user.username %>'s Profile</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background-color: #eef2f7;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .profile-header {
      background: #fff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      text-align: center;
      margin-bottom: 50px;
    }
    .section-title {
      margin-top: 40px;
      margin-bottom: 25px;
      font-weight: 600;
      color: #2c3e50;
      border-bottom: 2px solid #3498db;
      display: inline-block;
      padding-bottom: 5px;
    }
    .card-custom {
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.08);
      margin-bottom: 20px;
      padding: 20px;
      background: #fff;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .card-custom:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    }
    .btn-host {
      margin-top: 10px;
    }
    .badge-host {
      font-size: 0.9rem;
      padding: 0.4em 0.6em;
    }
  </style>
</head>
<body>
  <div class="container mt-5">

    <!-- USER INFO CARD -->
    <div class="profile-header">
      <h1><i class="bi bi-person-circle"></i> <%= user.username %></h1>
      <p><i class="bi bi-envelope"></i> <%= user.email %></p>
      <% if (user.isHost) { %>
        <span class="badge bg-success badge-host">Host</span>
      <% } else { %>
        <a href="/user/become-host" class="btn btn-outline-primary btn-sm btn-host">Become a Host</a>
      <% } %>
      <br><br>
      <a href="/user/logout" class="btn btn-danger">Logout</a>
    </div>

    <!-- BOOKINGS SECTION -->
    <h2 class="section-title">Your Bookings</h2>
    <div class="row">
      <% if (!bookings || bookings.length === 0) { %>
        <p class="text-muted">You have no bookings yet.</p>
      <% } else { %>
        <% bookings.forEach(booking => { %>
          <div class="col-md-6 col-lg-4">
            <div class="card-custom">
              <h5><i class="bi bi-house-door"></i> <%= booking.listing ? booking.listing.name : "Unknown Listing" %></h5>
              <p><i class="bi bi-calendar-event"></i> Date: <%= booking.createdAt.toDateString() %></p>
            </div>
          </div>
        <% }) %>
      <% } %>
    </div>

    <!-- USER LISTINGS SECTION -->
    <h2 class="section-title">Listings Added by You</h2>
    <div class="row">
      <% if (!user.listings || user.listings.length === 0) { %>
        <p class="text-muted">You haven't added any listings yet.</p>
      <% } else { %>
        <% user.listings.forEach(listing => { %>
          <div class="col-md-6 col-lg-4">
            <div class="card-custom">
              <h5><i class="bi bi-building"></i> <%= listing.title %></h5>
              <p><i class="bi bi-geo-alt"></i> Location: <%= listing.location %></p>
              <p><i class="bi bi-currency-dollar"></i> Price: $<%= listing.price %></p>
              <a href="/listings/<%= listing._id %>" class="btn btn-primary btn-sm">View Listing</a>
            </div>
          </div>
        <% }) %>
      <% } %>
    </div>

  </div>
</body>
</html>
