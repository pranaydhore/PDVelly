<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Favorites | PDVolley</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
      body { background: #f8f9fa; }
      .sidebar a.active { background: #e84c83; color: white; }
      .listing-card { border-radius: 10px; background: white; padding: 1rem; margin-bottom: 1rem; }
      .btn-fav { color: #e84c83; cursor: pointer; }
  </style>
</head>
<body>
  <div class="container my-4">
    <div class="row">
      <div class="col-md-3">
        <div class="sidebar p-3 bg-white rounded shadow-sm">
          <h4>Menu</h4>
          <a href="/user/profile" class="<%= active === 'profile' ? 'active' : '' %> d-block mb-2 p-2">Profile</a>
          <a href="/listings" class="<%= active === 'listings' ? 'active' : '' %> d-block mb-2 p-2">All Listings</a>
          <a href="/user/favorites" class="<%= active === 'favorites' ? 'active' : '' %> d-block mb-2 p-2">Favorites</a>
        </div>
      </div>
      <div class="col-md-9">
        <h2>Your Favorite Listings</h2>
        <% if (user.favorites.length > 0) { %>
          <div>
            <% user.favorites.forEach(listing => { %>
              <div class="listing-card shadow-sm">
                <h5><%= listing.title %></h5>
                <p><%= listing.description || 'No description available.' %></p>
                <form method="POST" action="/user/favorites/<%= listing._id %>" class="fav-form">
                  <button type="submit" class="btn btn-outline-danger btn-sm">Remove from favorites</button>
                </form>
              </div>
            <% }) %>
          </div>
        <% } else { %>
          <p>You have no favorite listings yet.</p>
        <% } %>
      </div>
    </div>
  </div>
  <script>
    // Optional: Handle favorite toggling via AJAX if desired
    document.querySelectorAll('.fav-form').forEach(form => {
      form.addEventListener('submit', async e => {
        e.preventDefault();
        const url = form.action;
        const response = await fetch(url, { method: 'POST' });
        if (response.ok) window.location.reload();
      });
    });
  </script>
</body>
</html>
